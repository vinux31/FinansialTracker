---
phase: 01-foundation-core-tracking
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/app/(dashboard)/layout.tsx
  - src/app/(dashboard)/page.tsx
  - src/app/layout.tsx
  - src/components/expense-form.tsx
  - src/components/today-summary.tsx
  - src/components/navigation.tsx
autonomous: true

must_haves:
  truths:
    - "User can log an expense in under 5 seconds (amount, category, optional notes)"
    - "User sees today's total spending immediately when opening the app"
    - "Form resets after successful submission for rapid re-entry"
    - "Navigation allows moving between Today, History, and Monthly views"
  artifacts:
    - path: "src/components/expense-form.tsx"
      provides: "Quick expense entry form"
      contains: "expenseSchema"
    - path: "src/components/today-summary.tsx"
      provides: "Today's total spending display"
      contains: "getTodayTotal"
    - path: "src/components/navigation.tsx"
      provides: "App navigation between views"
      contains: "history"
    - path: "src/app/(dashboard)/page.tsx"
      provides: "Main dashboard page with today's view"
      contains: "ExpenseForm"
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Dashboard layout with navigation"
      contains: "Navigation"
  key_links:
    - from: "src/components/expense-form.tsx"
      to: "src/lib/storage.ts"
      via: "addExpense call on form submit"
      pattern: "addExpense"
    - from: "src/components/expense-form.tsx"
      to: "src/lib/validation.ts"
      via: "validates form data with expenseSchema"
      pattern: "expenseSchema"
    - from: "src/components/today-summary.tsx"
      to: "src/lib/storage.ts"
      via: "reads today's transactions"
      pattern: "getTodayTransactions|getTodayTotal"
    - from: "src/app/(dashboard)/page.tsx"
      to: "src/components/expense-form.tsx"
      via: "renders expense form on main page"
      pattern: "ExpenseForm"
---

<objective>
Build the main dashboard page with quick expense entry form and today's spending summary -- the core daily-use interface.

Purpose: This is the primary user interaction. Opening the app should immediately show today's spending and allow logging a new expense in under 5 seconds.
Output: Working expense form, today's spending summary, and navigation layout.
</objective>

<execution_context>
@C:/Users/rinoa/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/rinoa/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-core-tracking/01-RESEARCH.md
@.planning/phases/01-foundation-core-tracking/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create navigation component and dashboard layout</name>
  <files>
    src/components/navigation.tsx
    src/app/(dashboard)/layout.tsx
    src/app/layout.tsx
  </files>
  <action>
    Create `src/components/navigation.tsx` -- a simple navigation bar with links to the three main views:

    - "Today" -> `/` (active by default)
    - "History" -> `/history`
    - "Monthly" -> `/monthly`

    Use 'use client' directive. Use `usePathname()` from `next/navigation` to highlight the active link. Style with Tailwind: horizontal nav bar, clean underline or background for active state. Keep it minimal -- this is a personal finance app, not a marketing site.

    Create `src/app/(dashboard)/layout.tsx` -- route group layout that wraps all dashboard pages:
    - Include Navigation component at the top
    - Main content area below with appropriate padding
    - Max width container (e.g., max-w-4xl mx-auto) for readability

    Update `src/app/layout.tsx` (the root layout created by create-next-app):
    - Set page title to "Finance Tracker"
    - Set appropriate metadata description
    - Keep the existing font and global styles setup from create-next-app
  </action>
  <verify>
    `npm run build` succeeds. Navigation component renders three links. Dashboard layout wraps child pages.
  </verify>
  <done>
    Navigation shows Today/History/Monthly links with active state highlighting. Dashboard layout provides consistent container and navigation across all pages.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build expense form and today's spending view</name>
  <files>
    src/components/expense-form.tsx
    src/components/today-summary.tsx
    src/app/(dashboard)/page.tsx
  </files>
  <action>
    Create `src/components/expense-form.tsx` -- the quick expense entry form:

    This is the most critical component. It must enable expense logging in under 5 seconds.

    Implementation:
    - 'use client' component
    - Three fields: amount (number input), category (select dropdown), notes (text input, optional)
    - Category select pre-populated with CATEGORIES from `@/types` (Makan, Transportasi, Rokok, Belanja, Lainnya)
    - Default category to 'Makan' (most common) so user only needs to type amount and hit enter for fastest path
    - Amount input should have `autoFocus` for immediate typing on page load
    - Use uncontrolled form with `formData` on submit (NOT controlled inputs with onChange -- avoids re-renders)
    - On submit: validate with `expenseSchema.safeParse()`, call `addExpense()` from storage, reset form via `formRef.current?.reset()`
    - Show validation errors below relevant fields using shadcn/ui styling
    - After successful add, call an `onExpenseAdded` callback prop to trigger parent refresh
    - Use shadcn/ui Button, Input, Label components. For category select, use a native `<select>` element styled with Tailwind (shadcn Select uses Radix which is heavy for a simple dropdown)
    - Disable submit button briefly after submission to prevent rapid double-clicks

    Create `src/components/today-summary.tsx` -- today's spending display:

    - 'use client' component
    - Shows today's date (formatted nicely, e.g., "Friday, 14 February 2026")
    - Shows today's total spending in large prominent IDR format (e.g., "Rp 125.000")
    - Shows list of today's transactions below (time, category, amount, notes)
    - Uses `getTodayTransactions()` and `getTodayTotal()` from storage
    - Uses `formatIDR()` from money for amount display
    - Load data in `useEffect` (hydration guard for localStorage)
    - Accept a `refreshKey` prop (number) that triggers re-read from storage when incremented
    - Handle empty state: "No expenses today" message

    Create `src/app/(dashboard)/page.tsx` -- the main Today page:

    - 'use client' component
    - Renders TodaySummary at the top (prominent, large)
    - Renders ExpenseForm below
    - Uses a `refreshKey` state counter: increment on expense added, pass to TodaySummary
    - This wiring ensures adding an expense immediately updates today's total
    - Clean layout: summary card on top, form card below
  </action>
  <verify>
    `npm run build` succeeds. Page renders at `/`. Form accepts amount/category/notes. Submitting adds to localStorage and today's total updates.
  </verify>
  <done>
    Expense form allows logging in under 5 seconds (autofocus amount, default category, enter to submit). Today's total spending displays prominently and updates immediately after adding an expense. Today's transaction list shows all entries for the current day.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds
2. Navigate to `/` -- see today's date, total spending (Rp 0 initially), expense form
3. Enter amount "15000", keep default category "Makan", submit -- today's total updates to "Rp 15.000"
4. Add another expense -- total updates correctly
5. Navigation links visible: Today, History, Monthly
6. Form resets after submission for rapid re-entry
7. Amount field has autofocus for immediate typing
</verification>

<success_criteria>
- Expense entry completes in under 5 seconds (type amount, submit)
- Today's total updates immediately after adding expense
- Today's transaction list shows all expenses logged today
- Navigation renders correctly with active state
- Form validation shows errors for invalid input
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-core-tracking/01-02-SUMMARY.md`
</output>
